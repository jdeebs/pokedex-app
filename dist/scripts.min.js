let pokemonRepository=(function(){let pokemonList=[];let apiUrl="https://pokeapi.co/api/v2/pokemon/?limit=150";let modal=document.querySelector(".modal");function createRow(parentElement){let rowDiv=document.createElement("div");rowDiv.classList.add("row");parentElement.appendChild(rowDiv);return rowDiv}
function createColumn(parentRow){let colDiv=document.createElement("div");colDiv.classList.add("col-md-4");parentRow.appendChild(colDiv);return colDiv}
function add(pokemon){if(typeof pokemon==="object"&&pokemon!==null){pokemonList.push(pokemon)}else{console.error("Error: Parameter of add() must be an object")}}
function getAll(){return pokemonList}
function addListItem(pokemon){let pokemonListElement=document.querySelector(".pokemon-list");let currentRow=document.querySelector(".row:last-of-type");if(!currentRow||currentRow.children.length>=3){currentRow=createRow(pokemonListElement)}
let colDiv=createColumn(currentRow);let listItem=document.createElement("li");let button=document.createElement("button");let pokemonName=pokemon.name.charAt(0).toUpperCase()+pokemon.name.slice(1);button.innerText=pokemonName;button.classList.add("btn","btn-lg");button.setAttribute("id","pokemonButton");button.setAttribute("data-target","pokemonModal");button.setAttribute("data-toggle","modal");listItem.classList.add("list-group-item");listItem.appendChild(button);colDiv.appendChild(listItem);button.addEventListener("click",function(){pokemonRepository.loadDetails(pokemon).then(function(){showModal(pokemon)})})}
function loadList(){showLoadingMessage();return(fetch(apiUrl).then(function(response){return response.json()}).then(function(json){json.results.forEach(function(item){let pokemon={name:item.name,detailsUrl:item.url,};add(pokemon)});hideLoadingMessage()}).catch(function(e){console.error(e)}))}
function loadDetails(item){showLoadingMessage();let url=item.detailsUrl;return(fetch(url).then(function(response){return response.json()}).then(function(details){item.imageUrlFront=details.sprites.front_default;item.imageUrlBack=details.sprites.back_default;item.height=details.height;item.types=details.types;hideLoadingMessage()}).catch(function(e){console.error(e)}))}
function showLoadingMessage(){setTimeout(function(){let loadingMessage=document.createElement("div");loadingMessage.innerText="Loading...";loadingMessage.classList.add("loading-message");document.body.appendChild(loadingMessage);setTimeout(function(){hideLoadingMessage()},0)},3000)}
function hideLoadingMessage(){let loadingMessage=document.querySelector(".loading-message");setTimeout(function(){if(loadingMessage){loadingMessage.remove()}},0)}
function showModal(item){$(".modal-title").empty();$(".modal-body").empty();let capitalName=item.name.charAt(0).toUpperCase()+item.name.slice(1);let nameElement=$("<h1>"+capitalName+"</h1>");let heightElement=$("<p>"+"Height: "+item.height+"</p>");let typesString="Types: ";item.types.forEach(function(type){typesString+=type.type.name+", "});typesString=typesString.slice(0,-2);let typesElement=$("<p>"+typesString+"</p>");let imageElementFront=$('<img class="modal-img" style="width:50%">');imageElementFront.attr("src",item.imageUrlFront);let imageElementBack=$('<img class="modal-img" style="width:50%">');imageElementBack.attr("src",item.imageUrlBack);$(".modal-title").append(nameElement);$(".modal-body").append(heightElement,typesElement,imageElementFront,imageElementBack);$("#pokemonModal").modal("show")}
function hideModal(){modalContainer.classList.remove("is-visible")}
window.addEventListener("keydown",(e)=>{if(e.key==="Escape"&&modalContainer.classList.contains("is-visible")){hideModal()}});modal.addEventListener("click",(e)=>{let target=e.target;if(target===modal){hideModal()}});return{add:add,getAll:getAll,addListItem:addListItem,loadList:loadList,loadDetails:loadDetails,showModal:showModal,}})();pokemonRepository.loadList().then(function(){pokemonRepository.getAll().forEach(function(pokemon){pokemonRepository.addListItem(pokemon)})});document.write(`<div class="pokedex-container-wrapper">`);document.write(`<div class="pokedex-container">`)